<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>LevPay Admin</title>
  <link rel="stylesheet" href="./admin.css" />
</head>

<body>
  <!-- Login Gate (wajib muncul dulu) -->
  <div class="gate" id="gate" aria-hidden="false">
    <div class="gate__bg"></div>
    <div class="gate__panel">
      <div class="brand">
        <div class="brand__logo">LP</div>
        <div class="brand__text">
          <div class="brand__title">LevPay Admin</div>
          <div class="brand__sub">Masukkan Admin Key. Tanpa key, UI terkunci.</div>
        </div>
      </div>

      <div class="form">
        <label class="lbl">Admin Key</label>
        <input id="adminKeyInput" class="inp" type="password" autocomplete="off" placeholder="contoh: LEVIN6824" />

        <div class="row">
          <button id="btnLogin" class="btn btn--pri">Masuk</button>
          <button id="btnClear" class="btn btn--ghost" type="button">Reset</button>
        </div>

        <div class="mini">
          <div class="mini__k">API Base</div>
          <div class="mini__v">
            <input id="apiBaseInput" class="inp inp--mini mono" placeholder="/api/levpay" />
          </div>
        </div>
        <div class="hint">
          Default aman: <span class="mono">/api/levpay</span> (root).  
          Admin page di <span class="mono">/admin/admin.html</span> gak bakal nambah path aneh.
        </div>

        <div id="loginMsg" class="msg" style="display:none;"></div>
      </div>
    </div>
  </div>

  <!-- App -->
  <div class="app" id="app">
    <header class="topbar">
      <div class="topbar__l">
        <div class="pillLogo">LP</div>
        <div>
          <div class="tTitle">LevPay Admin</div>
          <div class="tSub">API: <span id="apiBaseText" class="mono">—</span></div>
        </div>
      </div>

      <div class="topbar__r">
        <button id="btnRefresh" class="btn btn--ghost">Refresh</button>
        <button id="btnLogout" class="btn btn--danger">Logout</button>
      </div>
    </header>

    <main class="wrap">
      <aside class="side">
        <button class="nav is-on" data-tab="voucher">
          Voucher
          <span class="chip" id="chipVoucher">0</span>
        </button>
        <button class="nav" data-tab="monthly">
          Promo Bulanan
          <span class="chip" id="chipMonthly">—</span>
        </button>
        <button class="nav" data-tab="flags">
          Mode
          <span class="chip chip--tag">toggle</span>
        </button>

        <div class="card sideCard">
          <div class="kv">
            <div class="kv__k">Status</div>
            <div class="kv__v" id="sysStatus">LOCKED</div>
          </div>
          <div class="kv">
            <div class="kv__k">Last Sync</div>
            <div class="kv__v mono" id="lastSync">—</div>
          </div>
          <div class="hr"></div>
          <div class="small">
            Kalau curl admin bisa tapi frontend diskon 0, 99% masalahnya <b>createqr proxy</b> gak balikkin <span class="mono">pricing.amountFinal</span>.
          </div>
        </div>
      </aside>

      <section class="main">
        <!-- TAB: VOUCHER -->
        <section class="tab is-on" id="tab-voucher">
          <div class="grid2">
            <div class="card">
              <div class="card__head">
                <div>
                  <div class="h1">Voucher List</div>
                  <div class="h2">Klik item untuk edit. Bisa delete biar gak numpuk.</div>
                </div>
                <div class="row">
                  <label class="toggle">
                    <input id="onlyActive" type="checkbox" checked />
                    <span class="toggle__ui"></span>
                    <span class="toggle__txt">Active saja</span>
                  </label>
                  <button id="btnLoadVouchers" class="btn btn--ghost">Load</button>
                </div>
              </div>
              <div class="card__body pad0">
                <div class="tableWrap">
                  <table class="table">
                    <thead>
                      <tr>
                        <th>Code</th>
                        <th>Nama</th>
                        <th>On</th>
                        <th>%</th>
                        <th>MaxRp</th>
                        <th>Uses</th>
                        <th>Expire</th>
                        <th class="tr">Aksi</th>
                      </tr>
                    </thead>
                    <tbody id="voucherTbody">
                      <tr><td colspan="8" class="muted">Belum ada data.</td></tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>

            <div class="card">
              <div class="card__head">
                <div>
                  <div class="h1">Edit / Create</div>
                  <div class="h2">Voucher cuma kepake kalau user input kodenya.</div>
                </div>
              </div>

              <div class="card__body">
                <div class="formGrid">
                  <div>
                    <div class="lbl">Code</div>
                    <input id="v_code" class="inp mono" placeholder="VIPL" />
                  </div>
                  <div>
                    <div class="lbl">Name</div>
                    <input id="v_name" class="inp" placeholder="VIP LEVEL" />
                  </div>

                  <div>
                    <div class="lbl">Percent</div>
                    <input id="v_percent" class="inp mono" inputmode="numeric" placeholder="10" />
                  </div>
                  <div>
                    <div class="lbl">Max Rp (0=unlimited)</div>
                    <input id="v_maxRp" class="inp mono" inputmode="numeric" placeholder="0" value="0" />
                  </div>

                  <div class="full">
                    <div class="lbl">Max Uses (kosong=unlimited)</div>
                    <input id="v_maxUses" class="inp mono" inputmode="numeric" placeholder="" />
                  </div>

                  <div class="full">
                    <div class="lbl">Expires At (optional)</div>
                    <input id="v_expiresAt" class="inp mono" type="datetime-local" />
                  </div>

                  <div class="full row">
                    <label class="toggle">
                      <input id="v_enabled" type="checkbox" checked />
                      <span class="toggle__ui"></span>
                      <span class="toggle__txt">Enabled</span>
                    </label>
                  </div>
                </div>

                <div class="row gap">
                  <button id="btnUpsert" class="btn btn--pri">Simpan</button>
                  <button id="btnDisable" class="btn btn--ghost">Disable</button>
                  <button id="btnDelete" class="btn btn--danger">Delete</button>
                </div>

                <div id="msgVoucher" class="msg" style="display:none;"></div>

                <div class="split">
                  <div>
                    <div class="miniT">curl</div>
                    <pre class="code" id="curlVoucher">—</pre>
                  </div>
                  <div>
                    <div class="miniT">Response</div>
                    <pre class="code" id="jsonVoucher">—</pre>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- TAB: MONTHLY -->
        <section class="tab" id="tab-monthly">
          <div class="card">
            <div class="card__head">
              <div>
                <div class="h1">Promo Bulanan</div>
                <div class="h2">Bukan auto: wajib input kode. Device normal 1×/bulan.</div>
              </div>
              <div class="row">
                <button id="btnLoadMonthly" class="btn btn--ghost">Load</button>
                <button id="btnSaveMonthly" class="btn btn--pri">Save</button>
              </div>
            </div>

            <div class="card__body">
              <div class="formGrid">
                <div class="full row">
                  <label class="toggle">
                    <input id="m_enabled" type="checkbox" />
                    <span class="toggle__ui"></span>
                    <span class="toggle__txt">Enabled</span>
                  </label>
                </div>

                <div>
                  <div class="lbl">Kode Promo Bulanan</div>
                  <input id="m_code" class="inp mono" placeholder="KLZ" />
                </div>

                <div>
                  <div class="lbl">Name</div>
                  <input id="m_name" class="inp" placeholder="PROMO BULANAN" />
                </div>

                <div>
                  <div class="lbl">Percent</div>
                  <input id="m_percent" class="inp mono" inputmode="numeric" placeholder="5" />
                </div>

                <div>
                  <div class="lbl">Max Rp</div>
                  <input id="m_maxRp" class="inp mono" inputmode="numeric" placeholder="2000" />
                </div>

                <div class="full">
                  <div class="lbl">Max Uses / bulan (kosong = unlimited)</div>
                  <input id="m_maxUses" class="inp mono" inputmode="numeric" placeholder="" />
                </div>

                <div class="full row">
                  <label class="toggle">
                    <input id="m_requireCode" type="checkbox" checked />
                    <span class="toggle__ui"></span>
                    <span class="toggle__txt">Require Code (wajib)</span>
                  </label>
                </div>
              </div>

              <div id="msgMonthly" class="msg" style="display:none;"></div>

              <div class="split">
                <div>
                  <div class="miniT">curl</div>
                  <pre class="code" id="curlMonthly">—</pre>
                </div>
                <div>
                  <div class="miniT">Response</div>
                  <pre class="code" id="jsonMonthly">—</pre>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- TAB: FLAGS -->
        <section class="tab" id="tab-flags">
          <div class="card">
            <div class="card__head">
              <div>
                <div class="h1">Mode / Toggle</div>
                <div class="h2">
                  Toggle ini cuma ngaruh ke <b>device whitelist</b> yang udah diset di backend (ENV).
                  Admin page gak perlu SHA/pepper/deviceId.
                </div>
              </div>
              <div class="row">
                <button id="btnLoadFlags" class="btn btn--ghost">Load</button>
                <button id="btnSaveFlags" class="btn btn--pri">Save</button>
              </div>
            </div>

            <div class="card__body">
              <div class="flagGrid">
                <div class="flagItem">
                  <div class="flagItem__k">Monthly Unlimited Whitelist</div>
                  <div class="flagItem__s">ON = device whitelist unlimited (bypass 1×/bulan)</div>
                  <label class="switch">
                    <input id="f_monthlyUnlim" type="checkbox" />
                    <span class="switch__ui"></span>
                  </label>
                </div>

                <div class="flagItem">
                  <div class="flagItem__k">Voucher Unlimited Whitelist</div>
                  <div class="flagItem__s">ON = device whitelist bypass maxUses voucher</div>
                  <label class="switch">
                    <input id="f_voucherUnlim" type="checkbox" />
                    <span class="switch__ui"></span>
                  </label>
                </div>
              </div>

              <div id="msgFlags" class="msg" style="display:none;"></div>

              <div class="split">
                <div>
                  <div class="miniT">curl</div>
                  <pre class="code" id="curlFlags">—</pre>
                </div>
                <div>
                  <div class="miniT">Response</div>
                  <pre class="code" id="jsonFlags">—</pre>
                </div>
              </div>
            </div>
          </div>
        </section>

      </section>
    </main>

    <footer class="foot">
      <span>LevPay Admin</span><span class="dot">•</span><span class="mono">v2</span>
    </footer>
  </div>

  <script src="./admin.js"></script>
</body>
</html>