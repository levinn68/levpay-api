<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>LevPay Admin</title>
  <link rel="stylesheet" href="./assets/admin.css" />
</head>

<body>
  <!-- Blur gate -->
  <div id="gate" class="gate is-on" aria-hidden="false">
    <div class="gate__backdrop"></div>
    <div class="gate__panel">
      <div class="brand">
        <div class="brand__logo"></div>
        <div>
          <div class="brand__title">LevPay Admin</div>
          <div class="brand__sub">Masukkan Admin Key untuk mengakses pengaturan.</div>
        </div>
      </div>

      <div class="gate__form">
        <label class="label">Admin Key</label>
        <input id="adminKeyInput" class="input" placeholder="contoh: LEVIN6824" type="password" autocomplete="off" />

        <div class="row row--gap">
          <button id="btnLogin" class="btn btn--primary">Masuk</button>
          <button id="btnLogout" class="btn btn--ghost" disabled>Keluar</button>
        </div>

        <div class="hint">
          Default API: <code class="mono">/api/orkut</code> (ubah di file <code class="mono">admin.js</code> kalau kamu pakai <code class="mono">/api/levpay</code>)
        </div>

        <div id="loginMsg" class="msg" style="display:none;"></div>
      </div>
    </div>
  </div>

  <!-- App -->
  <div id="app" class="app is-locked">
    <header class="topbar">
      <div class="topbar__left">
        <div class="brandMini">
          <div class="brandMini__logo"></div>
          <div>
            <div class="brandMini__title">LevPay Admin</div>
            <div class="brandMini__sub">
              API: <span class="mono" id="apiBaseText">—</span>
            </div>
          </div>
        </div>
      </div>

      <div class="topbar__right">
        <button id="btnRefreshAll" class="btn btn--ghost">Refresh</button>
        <button id="btnOpenGate" class="btn btn--ghost">Admin Key</button>
      </div>
    </header>

    <main class="layout">
      <aside class="side">
        <div class="side__box">
          <button class="navItem is-active" data-tab="vouchers">
            <span>Voucher</span><span class="pill" id="pillVoucherCount">0</span>
          </button>
          <button class="navItem" data-tab="monthly">
            <span>Promo Bulanan</span><span class="pill" id="pillMonthly">—</span>
          </button>
          <button class="navItem" data-tab="tools">
            <span>Tools</span><span class="pill">curl</span>
          </button>
        </div>

        <div class="side__box side__box--mini">
          <div class="kv">
            <div class="kv__k">Status</div>
            <div class="kv__v" id="sysStatus">LOCKED</div>
          </div>
          <div class="kv">
            <div class="kv__k">Last Sync</div>
            <div class="kv__v mono" id="lastSync">—</div>
          </div>
        </div>
      </aside>

      <section class="main">
        <!-- VOUCHERS TAB -->
        <div class="tab is-on" id="tab-vouchers">
          <div class="grid2">
            <div class="card">
              <div class="card__head">
                <div>
                  <div class="card__title">Voucher Manager</div>
                  <div class="card__sub">Buat / update voucher, lalu disable voucher.</div>
                </div>
                <div class="row row--gap">
                  <label class="check">
                    <input id="onlyActiveToggle" type="checkbox" checked />
                    <span>Hanya yang aktif</span>
                  </label>
                  <button id="btnLoadVouchers" class="btn btn--ghost">Load</button>
                </div>
              </div>

              <div class="card__body">
                <div class="tableWrap">
                  <table class="table">
                    <thead>
                      <tr>
                        <th>Kode</th>
                        <th>Nama</th>
                        <th>Aktif</th>
                        <th>%</th>
                        <th>Max Rp</th>
                        <th>Max Uses</th>
                        <th>Expire</th>
                        <th class="tRight">Aksi</th>
                      </tr>
                    </thead>
                    <tbody id="voucherTbody">
                      <tr><td colspan="8" class="mutedCell">Belum ada data.</td></tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>

            <div class="card">
              <div class="card__head">
                <div>
                  <div class="card__title">Upsert Voucher</div>
                  <div class="card__sub">Isi detail voucher lalu simpan.</div>
                </div>
              </div>

              <div class="card__body">
                <div class="formGrid">
                  <div class="field">
                    <label class="label">Code</label>
                    <input id="v_code" class="input mono" placeholder="contoh: VIPL" />
                  </div>
                  <div class="field">
                    <label class="label">Name</label>
                    <input id="v_name" class="input" placeholder="contoh: VIP LEVEL" />
                  </div>

                  <div class="field">
                    <label class="label">Percent (0-100)</label>
                    <input id="v_percent" class="input" inputmode="numeric" placeholder="contoh: 60" />
                  </div>
                  <div class="field">
                    <label class="label">Max Rp (0 = unlimited)</label>
                    <input id="v_maxRp" class="input" inputmode="numeric" placeholder="contoh: 5000" />
                  </div>

                  <div class="field">
                    <label class="label">Max Uses (kosong = unlimited)</label>
                    <input id="v_maxUses" class="input" inputmode="numeric" placeholder="contoh: 100" />
                  </div>

                  <div class="field">
                    <label class="label">Expires At</label>
                    <input id="v_expiresAt" class="input" type="datetime-local" />
                    <div class="hint">Kosongkan kalau tidak ada expire.</div>
                  </div>

                  <div class="field field--full">
                    <label class="check">
                      <input id="v_enabled" type="checkbox" checked />
                      <span>Enabled</span>
                    </label>
                  </div>
                </div>

                <div class="row row--gap">
                  <button id="btnUpsertVoucher" class="btn btn--primary">Simpan Voucher</button>
                  <button id="btnDisableVoucher" class="btn btn--danger">Disable Voucher</button>
                </div>

                <div class="split">
                  <div>
                    <div class="miniTitle">curl (auto)</div>
                    <pre class="codebox" id="curlVoucher">—</pre>
                  </div>
                  <div>
                    <div class="miniTitle">Response</div>
                    <pre class="codebox" id="jsonVoucher">—</pre>
                  </div>
                </div>

                <div id="msgVoucher" class="msg" style="display:none;"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- MONTHLY TAB -->
        <div class="tab" id="tab-monthly">
          <div class="grid2">
            <div class="card">
              <div class="card__head">
                <div>
                  <div class="card__title">Promo Bulanan</div>
                  <div class="card__sub">1× per device per bulan (kecuali unlimited deviceKey).</div>
                </div>
                <div class="row row--gap">
                  <button id="btnLoadMonthly" class="btn btn--ghost">Load</button>
                  <button id="btnSaveMonthly" class="btn btn--primary">Save</button>
                </div>
              </div>

              <div class="card__body">
                <div class="formGrid">
                  <div class="field field--full">
                    <label class="check">
                      <input id="m_enabled" type="checkbox" />
                      <span>Enabled</span>
                    </label>
                  </div>

                  <div class="field">
                    <label class="label">Name</label>
                    <input id="m_name" class="input" placeholder="contoh: PROMO BULANAN" />
                  </div>

                  <div class="field">
                    <label class="label">Percent (0-100)</label>
                    <input id="m_percent" class="input" inputmode="numeric" placeholder="contoh: 5" />
                  </div>

                  <div class="field">
                    <label class="label">Max Rp</label>
                    <input id="m_maxRp" class="input" inputmode="numeric" placeholder="contoh: 2000" />
                  </div>

                  <div class="field">
                    <label class="label">Max Uses / bulan (kosong = unlimited)</label>
                    <input id="m_maxUses" class="input" inputmode="numeric" placeholder="contoh: 999 (limit global/bulan)" />
                    <div class="hint">Ini limit total pemakaian promo per bulan (global). Device tetap 1×/bulan.</div>
                  </div>
                </div>

                <div class="split">
                  <div>
                    <div class="miniTitle">curl (auto)</div>
                    <pre class="codebox" id="curlMonthly">—</pre>
                  </div>
                  <div>
                    <div class="miniTitle">Response</div>
                    <pre class="codebox" id="jsonMonthly">—</pre>
                  </div>
                </div>

                <div id="msgMonthly" class="msg" style="display:none;"></div>
              </div>
            </div>

            <div class="card">
              <div class="card__head">
                <div>
                  <div class="card__title">Unlimited DeviceKey</div>
                  <div class="card__sub">Tambah deviceKey (SHA256) untuk bypass limit bulanan.</div>
                </div>
              </div>

              <div class="card__body">
                <div class="formGrid">
                  <div class="field field--full">
                    <label class="label">Device ID</label>
                    <input id="dev_id" class="input mono" placeholder="contoh: dev_android_1" />
                  </div>

                  <div class="field field--full">
                    <label class="label">Device Pepper</label>
                    <input id="dev_pepper" class="input mono" placeholder="isi pepper yang sama dengan backend (DEVICE_PEPPER)" />
                    <div class="hint">Pepper harus sama dengan backend. Kalau beda, deviceKey juga beda.</div>
                  </div>

                  <div class="field field--full">
                    <label class="label">Generated deviceKey (SHA-256)</label>
                    <input id="dev_key" class="input mono" readonly />
                  </div>
                </div>

                <div class="row row--gap">
                  <button id="btnGenKey" class="btn btn--ghost">Generate</button>
                  <button id="btnAddUnlimited" class="btn btn--primary">Add Unlimited</button>
                  <button id="btnRemoveUnlimited" class="btn btn--danger">Remove</button>
                </div>

                <div class="tableWrap tableWrap--mini">
                  <table class="table">
                    <thead>
                      <tr>
                        <th>DeviceKey</th>
                        <th class="tRight">Aksi</th>
                      </tr>
                    </thead>
                    <tbody id="unlimitedTbody">
                      <tr><td colspan="2" class="mutedCell">Belum ada data.</td></tr>
                    </tbody>
                  </table>
                </div>

                <div id="msgUnlimited" class="msg" style="display:none;"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- TOOLS TAB -->
        <div class="tab" id="tab-tools">
          <div class="card">
            <div class="card__head">
              <div>
                <div class="card__title">Tools</div>
                <div class="card__sub">Test discount.apply biar kamu tau voucher & monthly kepake apa engga.</div>
              </div>
              <div class="row row--gap">
                <button id="btnRunApply" class="btn btn--primary">Run</button>
              </div>
            </div>

            <div class="card__body">
              <div class="formGrid">
                <div class="field">
                  <label class="label">Amount</label>
                  <input id="t_amount" class="input mono" inputmode="numeric" value="10000" />
                </div>
                <div class="field">
                  <label class="label">Device ID</label>
                  <input id="t_deviceId" class="input mono" value="dev_frontend_1" />
                </div>
                <div class="field">
                  <label class="label">Voucher</label>
                  <input id="t_voucher" class="input mono" placeholder="VIPL" />
                </div>
                <div class="field">
                  <label class="label">reserveTtlMs</label>
                  <input id="t_ttl" class="input mono" inputmode="numeric" value="360000" />
                </div>
              </div>

              <div class="split">
                <div>
                  <div class="miniTitle">curl (auto)</div>
                  <pre class="codebox" id="curlApply">—</pre>
                </div>
                <div>
                  <div class="miniTitle">Response</div>
                  <pre class="codebox" id="jsonApply">—</pre>
                </div>
              </div>

              <div class="hint">
                Kalau Termux bisa tapi frontend kamu nggak kepotong, biasanya:
                <span class="mono">HOST</span> beda / salah <span class="mono">action</span> / header admin dipakai ke endpoint publik.
              </div>
            </div>
          </div>
        </div>

      </section>
    </main>

    <footer class="footer">
      <div class="footer__inner">
        <span>LevPay Admin</span>
        <span class="sep">•</span>
        <span class="mono">v1</span>
      </div>
    </footer>
  </div>

  <script src="./admin.js"></script>
</body>
</html>
