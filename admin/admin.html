<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>LevPay Admin</title>
  <link rel="stylesheet" href="./assets/admin.css" />
</head>

<body>
  <!-- Blur gate -->
  <div id="gate" class="gate is-on" aria-hidden="false">
    <div class="gate__backdrop"></div>
    <div class="gate__panel">
      <div class="brand">
        <div class="brand__logo">LP</div>
        <div>
          <div class="brand__title">LevPay Admin</div>
          <div class="brand__sub">Masukkan Admin Key untuk mengakses pengaturan.</div>
        </div>
      </div>

      <div class="gate__form">
        <label class="label">Admin Key</label>
        <input id="adminKeyInput" class="input" placeholder="contoh: LEVIN6824" type="password" autocomplete="off" />

        <div class="row row--gap">
          <button id="btnLogin" class="btn btn--primary">Masuk</button>
          <button id="btnLogout" class="btn btn--ghost" disabled>Keluar</button>
        </div>

        <div class="hint">
          API router: <code class="mono">/api/levpay</code> (single file).
        </div>

        <div id="loginMsg" class="msg" style="display:none;"></div>
      </div>
    </div>
  </div>

  <!-- App -->
  <div id="app" class="app is-locked">
    <header class="topbar">
      <div class="topbar__left">
        <div class="brandMini">
          <div class="brandMini__logo">LP</div>
          <div>
            <div class="brandMini__title">LevPay</div>
            <div class="brandMini__sub">
              API: <span class="mono" id="apiBaseText">—</span>
            </div>
          </div>
        </div>
      </div>

      <div class="topbar__right">
        <div class="pill pill--muted" id="pillAccount">ACTIVE</div>
        <button id="btnRefreshAll" class="btn btn--ghost">Refresh</button>
        <button id="btnOpenGate" class="btn btn--ghost">Admin Key</button>
      </div>
    </header>

    <main class="layout">
      <aside class="side">
        <div class="side__box">
          <button class="navItem is-active" data-tab="info">
            <span>Info Diskon</span><span class="pill" id="pillInfo">—</span>
          </button>
          <button class="navItem" data-tab="vouchers">
            <span>Voucher</span><span class="pill" id="pillVoucherCount">0</span>
          </button>
          <button class="navItem" data-tab="monthly">
            <span>Promo Bulanan</span><span class="pill" id="pillMonthly">—</span>
          </button>
          <button class="navItem" data-tab="tools">
            <span>Tools</span><span class="pill">curl</span>
          </button>
        </div>

        <div class="side__box side__box--mini">
          <div class="kv">
            <div class="kv__k">Status</div>
            <div class="kv__v" id="sysStatus">LOCKED</div>
          </div>
          <div class="kv">
            <div class="kv__k">Last Sync</div>
            <div class="kv__v mono" id="lastSync">—</div>
          </div>
        </div>
      </aside>

      <section class="main">
        <!-- INFO TAB -->
        <div class="tab is-on" id="tab-info">
          <div class="grid2">
            <div class="card">
              <div class="card__head">
                <div>
                  <div class="card__title">Promo Bulanan (Info)</div>
                  <div class="card__sub">Status, diskon, limit global/bulan, dan usage bulan ini.</div>
                </div>
              </div>
              <div class="card__body">
                <div class="infoGrid">
                  <div class="kv">
                    <div class="kv__k">Enabled</div>
                    <div class="kv__v" id="infoMonthlyEnabled">—</div>
                  </div>
                  <div class="kv">
                    <div class="kv__k">Name</div>
                    <div class="kv__v" id="infoMonthlyName">—</div>
                  </div>
                  <div class="kv">
                    <div class="kv__k">Diskon</div>
                    <div class="kv__v" id="infoMonthlyPercent">—</div>
                  </div>
                  <div class="kv">
                    <div class="kv__k">Max Rp</div>
                    <div class="kv__v" id="infoMonthlyMaxRp">—</div>
                  </div>
                  <div class="kv">
                    <div class="kv__k">Max Uses (global/bulan)</div>
                    <div class="kv__v" id="infoMonthlyMaxUses">—</div>
                  </div>
                  <div class="kv">
                    <div class="kv__k">Used (bulan ini)</div>
                    <div class="kv__v" id="infoMonthlyUsed">—</div>
                  </div>
                </div>

                <div class="hr"></div>

                <div class="miniTitle">Generate deviceKey (SHA-256)</div>
                <div class="formGrid">
                  <div class="field">
                    <label class="label">Device ID</label>
                    <input id="info_deviceId" class="input mono" placeholder="contoh: dev_android_1" />
                  </div>
                  <div class="field">
                    <label class="label">Device Pepper</label>
                    <input id="info_pepper" class="input mono" placeholder="harus sama dengan DEVICE_PEPPER backend" />
                  </div>
                  <div class="field field--full">
                    <label class="label">deviceKey (SHA-256)</label>
                    <input id="info_deviceKey" class="input mono" readonly />
                    <div class="hint">Ini yang dipakai backend buat limit monthly (1×/device/bulan).</div>
                  </div>
                </div>
                <div class="btnRow" style="margin-top:10px;">
                  <button id="btnInfoGenKey" class="btn btn--ghost">Generate</button>
                  <button id="btnInfoCopyKey" class="btn btn--ghost">Copy</button>
                </div>
              </div>
            </div>

            <div class="card">
              <div class="card__head">
                <div>
                  <div class="card__title">Voucher Aktif (Info)</div>
                  <div class="card__sub">Daftar voucher ON. Scroll hanya di box.</div>
                </div>
                <div class="headActions">
                  <label class="seg">
                    <input id="onlyActiveToggle" type="checkbox" checked />
                    <span>Hanya ON</span>
                  </label>
                  <button id="btnLoadVouchersInfo" class="btn btn--ghost">Load</button>
                </div>
              </div>
              <div class="card__body card__body--pad0">
                <div class="tableWrap" id="voucherInfoWrap">
                  <table class="table">
                    <thead>
                      <tr>
                        <th>Kode</th>
                        <th>Nama</th>
                        <th>Aktif</th>
                        <th>%</th>
                        <th>Max Rp</th>
                        <th>Max Uses</th>
                        <th>Expire</th>
                      </tr>
                    </thead>
                    <tbody id="voucherInfoTbody">
                      <tr><td colspan="7" class="mutedCell">Belum ada data.</td></tr>
                    </tbody>
                  </table>
                </div>
              </div>
              <div class="card__foot">
                Kode voucher tidak disensor (sesuai request).
              </div>
            </div>
          </div>
        </div>

        <!-- VOUCHERS TAB -->
        <div class="tab" id="tab-vouchers">
          <div class="grid2">
            <div class="card">
              <div class="card__head">
                <div>
                  <div class="card__title">Voucher Manager</div>
                  <div class="card__sub">Buat / update voucher, lalu disable voucher.</div>
                </div>
                <div class="headActions">
                  <label class="seg">
                    <input id="onlyActiveToggle2" type="checkbox" checked />
                    <span>Hanya ON</span>
                  </label>
                  <button id="btnLoadVouchers" class="btn btn--ghost">Load</button>
                </div>
              </div>

              <div class="card__body card__body--pad0">
                <div class="tableWrap">
                  <table class="table">
                    <thead>
                      <tr>
                        <th>Kode</th>
                        <th>Nama</th>
                        <th>Aktif</th>
                        <th>%</th>
                        <th>Max Rp</th>
                        <th>Max Uses</th>
                        <th>Expire</th>
                        <th class="tRight">Pilih</th>
                      </tr>
                    </thead>
                    <tbody id="voucherTbody">
                      <tr><td colspan="8" class="mutedCell">Belum ada data.</td></tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>

            <div class="card">
              <div class="card__head">
                <div>
                  <div class="card__title">Upsert Voucher</div>
                  <div class="card__sub">curl + JSON otomatis di atas form.</div>
                </div>
              </div>

              <div class="card__body">
                <div class="miniTitle">curl (auto)</div>
                <pre class="codeBox" id="curlVoucher">—</pre>
                <div class="miniTitle" style="margin-top:10px;">Response</div>
                <pre class="codeBox codeBox--json" id="jsonVoucher">—</pre>

                <div class="hr"></div>

                <div class="formGrid">
                  <div class="field">
                    <label class="label">Code</label>
                    <input id="v_code" class="input mono" placeholder="contoh: VIPL" />
                  </div>
                  <div class="field">
                    <label class="label">Name</label>
                    <input id="v_name" class="input" placeholder="contoh: VIP LEVEL" />
                  </div>

                  <div class="field">
                    <label class="label">Percent (0-100)</label>
                    <input id="v_percent" class="input" inputmode="numeric" placeholder="contoh: 60" />
                  </div>
                  <div class="field">
                    <label class="label">Max Rp (0 = unlimited)</label>
                    <input id="v_maxRp" class="input" inputmode="numeric" placeholder="contoh: 5000" />
                  </div>

                  <div class="field">
                    <label class="label">Max Uses (kosong = unlimited)</label>
                    <input id="v_maxUses" class="input" inputmode="numeric" placeholder="contoh: 100" />
                  </div>

                  <div class="field">
                    <label class="label">Expires At</label>
                    <input id="v_expiresAt" class="input" type="datetime-local" />
                    <div class="hint">Kosongkan kalau tidak ada expire.</div>
                  </div>

                  <div class="field field--full">
                    <label class="check">
                      <input id="v_enabled" type="checkbox" checked />
                      <span>Enabled</span>
                    </label>
                  </div>
                </div>

                <div class="btnRow" style="margin-top:12px;">
                  <button id="btnUpsertVoucher" class="btn btn--primary">Simpan Voucher</button>
                  <button id="btnDisableVoucher" class="btn btn--danger">Disable Voucher</button>
                </div>

                <div id="msgVoucher" class="msg" style="display:none;"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- MONTHLY TAB -->
        <div class="tab" id="tab-monthly">
          <div class="grid2">
            <div class="card">
              <div class="card__head">
                <div>
                  <div class="card__title">Promo Bulanan</div>
                  <div class="card__sub">1× per device per bulan + optional maxUses global/bulan.</div>
                </div>
                <div class="headActions">
                  <button id="btnLoadMonthly" class="btn btn--ghost">Load</button>
                  <button id="btnSaveMonthly" class="btn btn--primary">Save</button>
                </div>
              </div>

              <div class="card__body">
                <div class="miniTitle">curl (auto)</div>
                <pre class="codeBox" id="curlMonthly">—</pre>
                <div class="miniTitle" style="margin-top:10px;">Response</div>
                <pre class="codeBox codeBox--json" id="jsonMonthly">—</pre>

                <div class="hr"></div>

                <div class="formGrid">
                  <div class="field field--full">
                    <label class="check">
                      <input id="m_enabled" type="checkbox" />
                      <span>Enabled</span>
                    </label>
                  </div>

                  <div class="field">
                    <label class="label">Name</label>
                    <input id="m_name" class="input" placeholder="contoh: PROMO BULANAN" />
                  </div>

                  <div class="field">
                    <label class="label">Percent (0-100)</label>
                    <input id="m_percent" class="input" inputmode="numeric" placeholder="contoh: 5" />
                  </div>

                  <div class="field">
                    <label class="label">Max Rp</label>
                    <input id="m_maxRp" class="input" inputmode="numeric" placeholder="contoh: 2000" />
                  </div>

                  <div class="field">
                    <label class="label">Max Uses / bulan (kosong = unlimited)</label>
                    <input id="m_maxUses" class="input" inputmode="numeric" placeholder="contoh: 100 (global per bulan)" />
                    <div class="hint">Device tetap 1×/bulan. Ini limit global pemakaian promo per bulan.</div>
                  </div>
                </div>

                <div id="msgMonthly" class="msg" style="display:none;"></div>
              </div>
            </div>

            <div class="card">
              <div class="card__head">
                <div>
                  <div class="card__title">Unlimited DeviceKey</div>
                  <div class="card__sub">Tambah deviceKey (SHA256) untuk bypass limit monthly.</div>
                </div>
              </div>

              <div class="card__body">
                <div class="formGrid">
                  <div class="field field--full">
                    <label class="label">Device ID</label>
                    <input id="dev_id" class="input mono" placeholder="contoh: dev_android_1" />
                  </div>

                  <div class="field field--full">
                    <label class="label">Device Pepper</label>
                    <input id="dev_pepper" class="input mono" placeholder="isi pepper sama dengan backend" />
                  </div>

                  <div class="field field--full">
                    <label class="label">Generated deviceKey (SHA-256)</label>
                    <input id="dev_key" class="input mono" readonly />
                  </div>
                </div>

                <div class="btnRow" style="margin-top:10px;">
                  <button id="btnGenKey" class="btn btn--ghost">Generate</button>
                  <button id="btnAddUnlimited" class="btn btn--primary">Add Unlimited</button>
                  <button id="btnRemoveUnlimited" class="btn btn--danger">Remove</button>
                </div>

                <div class="tableWrap" style="margin-top:12px; max-height:260px;">
                  <table class="table">
                    <thead>
                      <tr>
                        <th>DeviceKey</th>
                        <th class="tRight">Aksi</th>
                      </tr>
                    </thead>
                    <tbody id="unlimitedTbody">
                      <tr><td colspan="2" class="mutedCell">Belum ada data.</td></tr>
                    </tbody>
                  </table>
                </div>

                <div id="msgUnlimited" class="msg" style="display:none;"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- TOOLS TAB -->
        <div class="tab" id="tab-tools">
          <div class="card">
            <div class="card__head">
              <div>
                <div class="card__title">Tools</div>
                <div class="card__sub">Apply + Commit/Release (biar gak “kepake tapi belum bayar”).</div>
              </div>
              <div class="headActions">
                <button id="btnRunApply" class="btn btn--primary">Apply</button>
                <button id="btnRunCommit" class="btn btn--ghost">Commit</button>
                <button id="btnRunRelease" class="btn btn--danger">Release</button>
              </div>
            </div>

            <div class="card__body">
              <div class="formGrid">
                <div class="field">
                  <label class="label">Amount</label>
                  <input id="t_amount" class="input mono" inputmode="numeric" value="10000" />
                </div>
                <div class="field">
                  <label class="label">Device ID</label>
                  <input id="t_deviceId" class="input mono" value="dev_frontend_1" />
                </div>
                <div class="field">
                  <label class="label">Voucher</label>
                  <input id="t_voucher" class="input mono" placeholder="VIPL" />
                </div>
                <div class="field">
                  <label class="label">reserveTtlMs</label>
                  <input id="t_ttl" class="input mono" inputmode="numeric" value="360000" />
                </div>
              </div>

              <div class="miniTitle" style="margin-top:12px;">curl (auto)</div>
              <pre class="codeBox" id="curlApply">—</pre>
              <div class="miniTitle" style="margin-top:10px;">Response</div>
              <pre class="codeBox codeBox--json" id="jsonApply">—</pre>

              <div class="hint">
                Kalau apply doang tapi tidak bayar: klik <b>Release</b> supaya slot balik.
                Kalau sudah bayar: klik <b>Commit</b> supaya benar-benar kepake (uses++ / used deviceKey).
              </div>
            </div>
          </div>
        </div>

      </section>
    </main>

    <footer class="footer">
      <div class="footer__inner">
        <span>LevPay Admin</span>
        <span class="sep">•</span>
        <span class="mono">v1</span>
      </div>
    </footer>
  </div>

  <script src="./assets/admin.js"></script>
</body>
</html>